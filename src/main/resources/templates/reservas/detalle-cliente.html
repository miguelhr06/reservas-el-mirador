<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Detalle de Reserva - El Mirador</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <style>
        body {
            min-height: 100vh;
            background:
                linear-gradient(rgba(20, 40, 20, 0.85), rgba(20, 40, 20, 0.9)),
                url('/img/bg-campestre.jpg') center/cover fixed no-repeat;
            font-family: "Segoe UI", system-ui, -apple-system;
        }

        .card-reserva {
            border-radius: 22px;
            border: none;
            background: rgba(255, 255, 255, 0.97);
            box-shadow: 0 12px 38px rgba(0,0,0,0.45);
        }

        .header-reserva {
            border-radius: 22px 22px 0 0;
            background: linear-gradient(135deg, #3f7a3a, #7fbf58);
            color: #fff;
        }

        .header-reserva h4 {
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .badge-estado {
            border-radius: 999px;
            padding: 0.4rem 0.9rem;
            font-weight: 600;
            font-size: 0.85rem;
            background-color: #f1f8e9;
            color: #1b5e20;
        }

        .titulo-bloque {
            font-weight: 600;
            color: #2f4f2f;
        }

        .total-text {
            font-size: 1.9rem;
            font-weight: 800;
            color: #2e7d32;
            text-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .img-recurso {
            border-radius: 16px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.25);
            object-fit: cover;
        }

        .list-group-item {
            border-radius: 12px !important;
            margin-bottom: 0.4rem;
            border-color: #e0ebdf;
        }

        .btn-volver {
            border-radius: 999px;
            padding-inline: 2rem;
            font-weight: 600;
        }
    </style>
</head>

<body>
<div class="container py-5">

    <div class="row justify-content-center">
        <div class="col-lg-9">

            <div class="card card-reserva">

                <!-- CABECERA -->
                <div class="card-header header-reserva d-flex justify-content-between align-items-center">
                    <h4 class="m-0">
                        <i class="bi bi-journal-text me-2"></i>
                        Reserva <span th:text="${reserva.codigoReserva}"></span>
                    </h4>
                    <span class="badge-estado" th:text="${reserva.estado}">ESTADO</span>
                </div>

                <!-- CUERPO -->
                <div class="card-body p-4">
                    <div class="row g-4">

                        <!-- INFORMACIÓN DEL RECURSO -->
                        <div class="col-md-6">
                            <h5 class="titulo-bloque mb-3">Información del Recurso</h5>
                            <p class="mb-1">
                                <strong>Recurso:</strong>
                                <span th:text="${reserva.recurso.nombre}"></span>
                            </p>
                            <p class="mb-3">
                                <strong>Tipo:</strong>
                                <span th:text="${reserva.recurso.tipo.nombre}"></span>
                            </p>

                            <img th:if="${reserva.recurso.imagenUrl}"
                                 th:src="${reserva.recurso.imagenUrl}"
                                 class="img-fluid img-recurso mb-3"
                                 style="max-height: 220px; width: 100%;">

                        </div>

                        <!-- DETALLES DE LA RESERVA -->
                        <div class="col-md-6">
                            <h5 class="titulo-bloque mb-3">Detalles de la Reserva</h5>
                            <p class="mb-1">
                                <strong>Llegada:</strong>
                                <span th:text="${#temporals.format(reserva.fechaInicio, 'dd/MM/yyyy HH:mm')}"></span>
                            </p>
                            <p class="mb-1">
                                <strong>Salida:</strong>
                                <span th:text="${#temporals.format(reserva.fechaFin, 'dd/MM/yyyy HH:mm')}"></span>
                            </p>
                            <p class="mb-3">
                                <strong>Personas:</strong>
                                <span th:text="${reserva.cantidadPersonas}"></span>
                            </p>

                            <hr>

                            <h5 class="mb-1">Total</h5>
                            <div class="total-text">
                                S/ <span th:text="${reserva.precioTotal}"></span>
                            </div>
                        </div>
                    </div>

                    <!-- HISTORIAL DE PAGOS -->
                    <div th:if="${!reserva.pagos.isEmpty()}" class="mt-4">
                        <h5 class="titulo-bloque mb-3">Historial de Pagos</h5>
                        <ul class="list-group border-0">
                            <li class="list-group-item d-flex justify-content-between align-items-center"
                                th:each="pago : ${reserva.pagos}">
                                <span>
                                    Pago vía
                                    <strong th:text="${pago.metodoPago}"></strong>
                                    (<span th:text="${#temporals.format(pago.fechaPago, 'dd/MM/yyyy')}"></span>)
                                </span>
                                <span class="text-end">
                                    S/ <span th:text="${pago.monto}"></span>
                                    <span class="badge bg-secondary ms-2" th:text="${pago.estado}"></span>
                                </span>
                            </li>
                        </ul>
                    </div>

                    <div th:if="${reserva.pagos.isEmpty()}" class="mt-4">
                        <div class="alert alert-secondary mb-0">
                            Aún no se registran pagos para esta reserva.
                        </div>
                    </div>
                </div>

                <!-- FOOTER -->
                <div class="card-footer text-center bg-white border-0 pb-4">
                    <a href="/reservas/mis-reservas" class="btn btn-secondary btn-volver">
                        Volver a Mis Reservas
                    </a>
                </div>
            </div>

        </div>
    </div>

</div>
</body>
</html>
